console.clear();var enemy_fall_speed=2,enemy_fall_max=12,enemy_wave=0,hit_r=30,control=!0,score=0,score_add=.8,$stage=document.querySelector(".c-game__stage"),$yuzu=document.querySelector(".c-game__yuzu"),$scorePrint=document.querySelector(".c-game__score");$yuzu.style.top=($stage.offsetHeight-$yuzu.offsetHeight)/2+"px",$yuzu.style.left=$yuzu.offsetWidth+"px";var $start=document.querySelector(".c-game__start");$start.addEventListener("click",startGame);var loop=setInterval(fallAndHit,1e3/60);function startGame(){const e=new Audio("music/voice_102151.aac");e.play(),e.loop=!0,$start.classList.add("is-active"),$start.innerHTML="",createEnemy(),enemy_fall_speed=2,enemy_wave=0,control=!0,score=0,score_add=.8,$yuzu.style.top=($stage.offsetHeight-$yuzu.offsetHeight)/2+"px"}function fallAndHit(){document.querySelectorAll(".c-game__enemy").forEach((function(e){var t=e.offsetLeft;t<500&&e.dataset.wave==enemy_wave&&(enemy_wave++,createEnemy());var a=($yuzu.offsetLeft+$yuzu.offsetWidth)/2,o=($yuzu.offsetTop+$yuzu.offsetHeight)/2,r=(t+e.offsetWidth)/2,s=(e.offsetTop+e.offsetHeight)/2,n=Math.sqrt(Math.pow(a-r,2)+Math.pow(o-s,2));hit_r+2>n&&gameOver(),t<-80?e.remove():(e.style.left=t-enemy_fall_speed+"px",score+=score_add,$scorePrint.innerHTML=parseInt(score))}))}var speedUp=setInterval((function(){score_add+=.2,(enemy_fall_speed+=.5)>=enemy_fall_max&&clearInterval(speedUp)}),1e3);function createEnemy(){for(var e=[-30,90,210,330,450],t=0;t<2;t++){var a=document.createElement("div");a.setAttribute("class","sprite c-game__enemy"),a.setAttribute("data-wave",enemy_wave),$stage.append(a);var o=document.createElement("img");0==t?(o.setAttribute("src","img/JSF.jpg"),o.setAttribute("alt","JSF")):(o.setAttribute("src","img/ISU.jpg"),o.setAttribute("alt","ISU")),a.append(o);var r=Math.floor(Math.random()*e.length),s=e.splice(r,1);a.style.top=s+"px",a.style.left="900px"}}function gameOver(){clearInterval(loop),control=!1;var e=document.createElement("div");e.setAttribute("class","c-game__over is-active"),$stage.append(e);var t=document.createElement("div");t.setAttribute("class","c-game__over text"),t.textContent="遊戲結束",e.append(t);var a=document.createElement("div");a.setAttribute("class","c-game__over start"),a.textContent="重新開始",e.append(a),a.addEventListener("click",(function(){a.textContent="",t.textContent="",e.classList.remove("is-active"),loop=setInterval(fallAndHit,1e3/60),startGame()}))}var body=document.querySelector("body");function keyboard(e){if(control)switch(e.keyCode){case 83:(t=parseInt($yuzu.offsetTop))<$stage.offsetHeight-$yuzu.offsetHeight+10&&($yuzu.style.top=t+30+"px");break;case 87:var t;(t=parseInt($yuzu.offsetTop))>-10&&($yuzu.style.top=t-30+"px")}}body.addEventListener("keydown",keyboard,!1);